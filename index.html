<!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />

    <link rel="stylesheet" type="text/css" href="css/Bootstrap.css" />
    <title>Shivam ITCS - Products Demo</title>
    <style type="text/css">
        body {
            background: #eee;
        }

        html, body {
            position: relative;
            height: 100%;
        }

        .login-container {
            position: relative;
            width: 300px;
            margin: 0px auto;
            text-align: center;
            /* padding: 20px 40px 40px;

                background: #fff;
                border: 1px solid #ccc;*/
        }


        #output.alert-success {
            background: rgb(25, 204, 25);
        }

        #output.alert-danger {
            background: rgb(228, 105, 105);
            color: #ffffff;
        }


        .login-container::before, .login-container::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            top: 3.5px;
            left: 0;
            z-index: -1;
        }

        .login-container::after {
            top: 45px;
            -webkit-transform: rotateZ(-2deg);
            -moz-transform: rotateZ(-2deg);
            -ms-transform: rotateZ(-2deg);
        }

        .avatar {
            width: 100px;
            height: 100px;
            margin: 10px auto 30px;
            border-radius: 100%;
            border: 2px solid #aaa;
            background-size: cover;
        }



        .form-box input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            text-align: center;
            height: 40px;
            border: 1px solid #ccc;
            ;
            background: #fafafa;
            transition: 0.2s ease-in-out;
        }

            .form-box input:focus {
                outline: 0;
                background: #eee;
            }

            .form-box input[type="text"] {
                border-radius: 5px 5px 0 0;
                text-transform: lowercase;
            }

            .form-box input[type="password"] {
                /*border-radius: 0 0 5px 5px;
                border-top: 0;*/
                border-radius: 5px 5px 0 0;
            }

        .form-box button.login {
            margin-top: 15px;
            padding: 10px 20px;
        }

        .animated {
            -webkit-animation-duration: 1s;
            animation-duration: 1s;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
        }

        @-webkit-keyframes fadeInUp {
            0% {
                opacity: 0;
                -webkit-transform: translateY(20px);
                transform: translateY(20px);
            }

            100% {
                opacity: 1;
                -webkit-transform: translateY(0);
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                -webkit-transform: translateY(20px);
                -ms-transform: translateY(20px);
                transform: translateY(20px);
            }

            100% {
                opacity: 1;
                -webkit-transform: translateY(0);
                -ms-transform: translateY(0);
                transform: translateY(0);
            }
        }

        .fadeInUp {
            -webkit-animation-name: fadeInUp;
            animation-name: fadeInUp;
        }

        .avatar {
            background: url(img/logon.png);
            background-size: 50px 50px;
            background-repeat: no-repeat;
            background-position: center;
        }
    </style>
</head>
<body>
    <div id="header" data-role="ejmheader" data-ej-title="Clearly Inventory"></div>
    <div class="container">
        <div class="login-container">

            <div class="avatar">
                <img />

            </div>
            <div id="output"></div>
            <h5>Sign In - Clearly Inventory</h5>
            <div class="form-box">
                <form action="" method="">
                    <input name="user" type="text" id="accountname" placeholder="accountname">
                    <input name="user" type="text" id="username" placeholder="username">
                    <input type="password" id="password" placeholder="password"><br /><br /><br />
                    <button class="btn btn-info btn-block login" onclick="Login()" type="button">Login</button>
                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="Scripts/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="Scripts/Bootstrap.js"></script>
    <script type="text/javascript">

        var PayloadToken = "";
        function loadPage(url, onleave, onenter) {

            // If onleave function specified
            if (onleave) {
                onleave();
            }

            var xmlhttp = new XMLHttpRequest();

            // Callback function when XMLHttpRequest is ready
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState === 4) {
                    if (xmlhttp.status === 200) {
                        document.getElementById('container').innerHTML = xmlhttp.responseText;

                        // If onenter function specified
                        if (onenter) {
                            onenter();
                        }
                    }
                    else {
                        document.getElementById('container').innerHTML = "Error loading page " + url;
                    }
                }
            };
            xmlhttp.open("GET", url, true);
            xmlhttp.send();
        }

        function Login() {
            var loginurl = 'http://app.clearlyinventory.com/API/ClearlyInventoryAPI.svc/Login';
            var username = $('#username').val();
            var password = $('#password').val();
            var accountname = $("#accountname").val();
            if (username != "" && password != "") {
                $.ajax
                ({
                    type: "POST",
                    url: loginurl,
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'text json',
                    data: JSON.stringify({ "UserName": username, "Password": password, "AccountName": accountname }),
                    success: function (response) {
                        alert("success");

                        if (response.LoginResult.Success == true) {
                            // alert(response.LoginResult.Payload);
                            // debugger;
                            PayloadToken = response.LoginResult.Payload;
                            //  CurrentUserDetail.UserName=username;
                            // CurrentUserDetail.AccountName=accountname;
                            //CurrentUserDetail.payload=PayloadToken;
                            window.location.href = "DeviceFunctions.html?mytoken=" + PayloadToken;

                        }
                        else {
                            $("#output").addClass("alert alert-danger animated fadeInUp").html(response.LoginResult.Message).show();

                        }


                    },
                    error: function (err) {
                        alert("error");
                        $("#output").addClass("alert alert-danger animated fadeInUp").html(err.responseText).show();
                    }
                });
            }
            else {
                //remove success mesage replaced with error message
                $("#output").removeClass(' alert alert-success');
                $("#output").addClass("alert alert-danger animated fadeInUp").html("sorry enter a username and password").show();
                setTimeout(function () {
                    $("#output").addClass("alert alert-danger animated fadeInUp").html("sorry enter a username and password").hide();
                }, 5000);

            }

        }

    </script>
</body>
</html>